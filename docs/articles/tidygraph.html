<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html>
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>tidygraph and ggraph • ggraph</title>
<!-- jquery --><script src="https://code.jquery.com/jquery-3.1.0.min.js" integrity="sha384-nrOSfDHtoPMzJHjVTdCopGqIqeYETSXhZDFyniQ8ZHcVy08QesyHcnOUpMpqnmWq" crossorigin="anonymous"></script><!-- Bootstrap --><link href="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.7/css/bootstrap.min.css" rel="stylesheet" integrity="sha384-BVYiiSIFeK1dGmJRAkycuHAHRg32OmUcww7on3RYdg4Va+PmSTsz/K68vbdEjh4u" crossorigin="anonymous">
<script src="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.7/js/bootstrap.min.js" integrity="sha384-Tc5IQib027qvyjSMfHjOMaLkfuWVxZxUPnCJA7l2mCWNIpG9mGCD8wGNIcPD7Txa" crossorigin="anonymous"></script><!-- Font Awesome icons --><link href="https://maxcdn.bootstrapcdn.com/font-awesome/4.6.3/css/font-awesome.min.css" rel="stylesheet" integrity="sha384-T8Gy5hrqNKT+hzMclPo118YTQO6cYprQmhrYwIiQ/3axmI1hQomh7Ud2hPOy8SP1" crossorigin="anonymous">
<!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/1.7.1/clipboard.min.js" integrity="sha384-cV+rhyOuRHc9Ub/91rihWcGmMmCXDeksTtCihMupQHSsi8GIIRDG0ThDc3HGQFJ3" crossorigin="anonymous"></script><!-- pkgdown --><link href="../pkgdown.css" rel="stylesheet">
<script src="../jquery.sticky-kit.min.js"></script><script src="../pkgdown.js"></script><meta property="og:title" content="tidygraph and ggraph">
<meta property="og:description" content="">
<meta property="og:image" content="/logo.png">
<meta name="twitter:card" content="summary">
<!-- mathjax --><script src="https://mathjax.rstudio.com/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->
</head>
<body>
    <div class="container template-article">
      <header><div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar">
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="../index.html">ggraph</a>
        <span class="label label-default" data-toggle="tooltip" data-placement="bottom" title="Released package">1.0.1.9999</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
<li>
  <a href="../index.html">
    <span class="fa fa-home fa-lg"></span>
     
  </a>
</li>
<li>
  <a href="../reference/index.html">Reference</a>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" aria-expanded="false">
    Articles
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
<li>
      <a href="../articles/Edges.html">Edges</a>
    </li>
    <li>
      <a href="../articles/Layouts.html">Layouts</a>
    </li>
    <li>
      <a href="../articles/Nodes.html">Nodes</a>
    </li>
    <li>
      <a href="../articles/tidygraph.html">tidygraph and ggraph</a>
    </li>
  </ul>
</li>
<li>
  <a href="../news/index.html">Changelog</a>
</li>
      </ul>
<ul class="nav navbar-nav navbar-right">
<li>
  <a href="https://github.com/thomasp85/ggraph">
    <span class="fa fa-github fa-lg"></span>
     
  </a>
</li>
      </ul>
</div>
<!--/.nav-collapse -->
  </div>
<!--/.container -->
</div>
<!--/.navbar -->

      
      </header><div class="row">
  <div class="col-md-9 contents">
    <div class="page-header toc-ignore">
      <h1>tidygraph and ggraph</h1>
                        <h4 class="author">Thomas Lin Pedersen</h4>
            
            <h4 class="date">2018-06-11</h4>
      
      <small class="dont-index">Source: <a href="https://github.com/thomasp85/ggraph/blob/master/vignettes/tidygraph.Rmd"><code>vignettes/tidygraph.Rmd</code></a></small>
      <div class="hidden name"><code>tidygraph.Rmd</code></div>

    </div>

    
    
<p>Following <code>ggraph</code> v2.0 the <code>tidygraph</code> package has been used as the central data structure. The integration goes beyond using it as a simple background engine and has deep implications for what you can do and how you can do it when plotting with <code>ggraph</code>. This vignette will go into the details of the <code>ggraph</code>/<code>tidygraph</code> relationship — buckle up…</p>
<div id="supported-data-structures" class="section level2">
<h2 class="hasAnchor">
<a href="#supported-data-structures" class="anchor"></a>Supported data structures</h2>
<p>Prior to v2 <code>ggraph</code> had two main supported data structures, namely <code>dendrogram</code> and <code>igraph</code>. In addition <code>hclust</code> and <code>network</code> were supported by automatic conversion to <code>dendrogram</code> and <code>igraph</code> respectively. Each of the two data structures had their own layouts and under the hood two different set of functionality had to be maintained to extract nodes and edges etc. In v2 and going forward this has been simplified and <code>ggraph</code> now uses only <code>tbl_graph</code> as a graph representation. This does not mean that you’re out of luck if you’re not buying into the whole <code>tidygraph</code> idea. Every object supported by <code>tidygraph</code> is supported directly in <code>ggraph</code> by automatic conversion to <code>tbl_graph</code>. This means that <code>igraph</code>, <code>dendrogram</code>, <code>hclust</code>, and <code>network</code> is still supported in addition to <code>data.tree</code>, <code>phylo</code>, and <code>graph</code> as well as a number of <code>data.frame</code>, <code>matrix</code>, and <code>list</code> representations.</p>
<p>The change has reduced internal code complexity quite a bit which will make it easier to provide new features in future. From a user point of view it has the benefit of simplifying the API in that <code>ggraph</code> doesn’t really care what type of network object you pass in - every layout and geom just works with every data structure. Further, it simplifies how to add <code>ggraph</code> support to additional data structures: just write an <code><a href="http://www.rdocumentation.org/packages/tidygraph/topics/tbl_graph">as_tbl_graph()</a></code> method for the class!. Due to the large support of classes and data structures in <code>tidygraph</code> this should relatively straightforward. If you’re developer of a package that defines a custom network class simply export an <code><a href="http://www.rdocumentation.org/packages/tidygraph/topics/tbl_graph">as_tbl_graph()</a></code> method for the class to gain native <code>ggraph</code> (and <code>tidygraph</code>) support, or add it directly to <code>tidygraph</code> through a <a href="https://github.com/thomasp85/tidygraph/pulls">PR</a>.</p>
<p>This simplification for both me and the users have really been the motivation for the integration of <code>tidygraph</code> but as it were it has also allowed or instigated a number of cool new features that will be explored below.</p>
</div>
<div id="nse-in-layout-specifications" class="section level2">
<h2 class="hasAnchor">
<a href="#nse-in-layout-specifications" class="anchor"></a>NSE in layout specifications</h2>
<p>In <code>ggraph</code> the initiation will need to specify a layout to use for the subsequent node and edge geoms. Many of these layouts use different node and edge variables in their calculations e.g. a node size or an edge weight. Prior to v2 these arguments would simply take a string naming the respective variable to use, but following the v2 update these arguments implement Non-Standard Evaluation (NSE) in a manner known from both <code>dplyr</code> and <code>ggplot2</code> where it is used inside <code>aes()</code> calls. Depending on whether the argument refers to a node or edge value the provided expression will be evaluated in the context of nodes or edges respectively. The bottomline is that given a network such as this:</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">library</span>(tidygraph)

graph &lt;-<span class="st"> </span><span class="kw"><a href="http://www.rdocumentation.org/packages/tidygraph/topics/tbl_graph">as_tbl_graph</a></span>(
    <span class="kw">data.frame</span>(
        <span class="dt">from =</span> <span class="kw">sample</span>(<span class="dv">5</span>, <span class="dv">20</span>, <span class="ot">TRUE</span>),
        <span class="dt">to =</span> <span class="kw">sample</span>(<span class="dv">5</span>, <span class="dv">20</span>, <span class="ot">TRUE</span>),
        <span class="dt">weight =</span> <span class="kw">runif</span>(<span class="dv">20</span>)
    )
)
graph</code></pre></div>
<pre><code>## # A tbl_graph: 5 nodes and 20 edges
## #
## # A directed multigraph with 1 component
## #
## # Node Data: 5 x 1 (active)
##   name 
##   &lt;chr&gt;
## 1 3    
## 2 5    
## 3 2    
## 4 1    
## 5 4    
## #
## # Edge Data: 20 x 3
##    from    to weight
##   &lt;int&gt; &lt;int&gt;  &lt;dbl&gt;
## 1     1     3  0.948
## 2     2     4  0.490
## 3     3     2  0.737
## # ... with 17 more rows</code></pre>
<p>Then, instead of writing:</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw"><a href="../reference/ggraph.html">ggraph</a></span>(graph, <span class="dt">layout =</span> <span class="st">'fr'</span>, <span class="dt">weights =</span> <span class="st">"weight"</span>) <span class="op">+</span><span class="st"> </span>
<span class="st">    </span><span class="kw"><a href="../reference/geom_edge_link.html">geom_edge_link</a></span>() <span class="op">+</span><span class="st"> </span>
<span class="st">    </span><span class="kw"><a href="../reference/geom_node_point.html">geom_node_point</a></span>()</code></pre></div>
<p>You would simply write:</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw"><a href="../reference/ggraph.html">ggraph</a></span>(graph, <span class="dt">layout =</span> <span class="st">'fr'</span>, <span class="dt">weights =</span> weight) <span class="op">+</span><span class="st"> </span>
<span class="st">    </span><span class="kw"><a href="../reference/geom_edge_link.html">geom_edge_link</a></span>() <span class="op">+</span><span class="st"> </span>
<span class="st">    </span><span class="kw"><a href="../reference/geom_node_point.html">geom_node_point</a></span>()</code></pre></div>
<p><img src="tidygraph_files/figure-html/unnamed-chunk-4-1.png" width="700"></p>
<p>This change means that it is much easier to experiment with modifications to node and edge parameters affecting layouts as it is not necessary to modify the underlying graph but only the plotting code, e.g.:</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw"><a href="../reference/ggraph.html">ggraph</a></span>(graph, <span class="dt">layout =</span> <span class="st">'fr'</span>, <span class="dt">weights =</span> <span class="kw">log</span>(weight)) <span class="op">+</span><span class="st"> </span>
<span class="st">    </span><span class="kw"><a href="../reference/geom_edge_link.html">geom_edge_link</a></span>() <span class="op">+</span><span class="st"> </span>
<span class="st">    </span><span class="kw"><a href="../reference/geom_node_point.html">geom_node_point</a></span>()</code></pre></div>
<p><img src="tidygraph_files/figure-html/unnamed-chunk-5-1.png" width="700"></p>
</div>
<div id="access-to-tidygraph-algorithms-in-ggraph-code" class="section level2">
<h2 class="hasAnchor">
<a href="#access-to-tidygraph-algorithms-in-ggraph-code" class="anchor"></a>Access to tidygraph algorithms in ggraph code</h2>
<p>The most important improvement resulting from the integration of <code>tidygraph</code> and <code>ggraph</code> is that <code>tidygraph</code> algorithms are now directly usable within <code>ggraph</code> calls. This means that it is no longer necessary to precompute and store derived node and edge variables on the graph in order to use them in a plot:</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">graph &lt;-<span class="st"> </span><span class="kw"><a href="http://www.rdocumentation.org/packages/tidygraph/topics/create_graphs">create_notable</a></span>(<span class="st">'zachary'</span>)

<span class="kw"><a href="../reference/ggraph.html">ggraph</a></span>(graph, <span class="dt">layout =</span> <span class="st">'fr'</span>) <span class="op">+</span><span class="st"> </span>
<span class="st">    </span><span class="kw"><a href="../reference/geom_edge_link.html">geom_edge_link</a></span>() <span class="op">+</span><span class="st"> </span>
<span class="st">    </span><span class="kw"><a href="../reference/geom_node_point.html">geom_node_point</a></span>(<span class="kw">aes</span>(<span class="dt">size =</span> <span class="kw"><a href="http://www.rdocumentation.org/packages/tidygraph/topics/centrality">centrality_pagerank</a></span>())) <span class="op">+</span><span class="st"> </span>
<span class="st">    </span><span class="kw">theme</span>(<span class="dt">legend.position =</span> <span class="st">'bottom'</span>)</code></pre></div>
<p><img src="tidygraph_files/figure-html/unnamed-chunk-6-1.png" width="700"></p>
<p>here it is not necessary to first compute the pagerank centrality and store it as a node variable in order to plot it, and if you’re interested in looking at one of the myriad of other centrality measures you simply change the plotting code. This feature makes it much easier and painfree to investigate the effect of different graph measures on your plots and is a huge benefit when iterating on your visualisation.</p>
<p>Access to <code>tidygraph</code> is available within <code><a href="../reference/ggraph.html">ggraph()</a></code> and <code>aes()</code> calls, and within <code>facet</code> formulas. It is thus possible to use algorithms when specifying layouts, adding aesthetics to geoms and splitting into subplots - all areas were ease of iteration is vital:</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw"><a href="../reference/ggraph.html">ggraph</a></span>(graph, <span class="st">'matrix'</span>, <span class="dt">sort.by =</span> <span class="kw"><a href="http://www.rdocumentation.org/packages/tidygraph/topics/node_rank">node_rank_leafsort</a></span>()) <span class="op">+</span><span class="st"> </span>
<span class="st">    </span><span class="kw"><a href="../reference/geom_edge_point.html">geom_edge_point</a></span>(<span class="kw">aes</span>(<span class="dt">colour =</span> <span class="kw"><a href="http://www.rdocumentation.org/packages/tidygraph/topics/centrality">centrality_edge_betweenness</a></span>()), <span class="dt">mirror =</span> <span class="ot">TRUE</span>) <span class="op">+</span><span class="st"> </span>
<span class="st">    </span><span class="kw">theme</span>(<span class="dt">legend.position =</span> <span class="st">'bottom'</span>)</code></pre></div>
<p><img src="tidygraph_files/figure-html/unnamed-chunk-7-1.png" width="700"></p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw"><a href="../reference/ggraph.html">ggraph</a></span>(graph, <span class="st">'fr'</span>) <span class="op">+</span><span class="st"> </span>
<span class="st">    </span><span class="kw"><a href="../reference/geom_edge_link.html">geom_edge_link</a></span>() <span class="op">+</span><span class="st"> </span>
<span class="st">    </span><span class="kw"><a href="../reference/geom_node_point.html">geom_node_point</a></span>() <span class="op">+</span><span class="st"> </span>
<span class="st">    </span><span class="kw"><a href="../reference/facet_nodes.html">facet_nodes</a></span>(<span class="op">~</span><span class="st"> </span><span class="kw"><a href="http://www.rdocumentation.org/packages/tidygraph/topics/group_graph">group_infomap</a></span>())</code></pre></div>
<p><img src="tidygraph_files/figure-html/unnamed-chunk-8-1.png" width="700"></p>
</div>
  </div>

  <div class="col-md-3 hidden-xs hidden-sm" id="sidebar">
        <div id="tocnav">
      <h2 class="hasAnchor">
<a href="#tocnav" class="anchor"></a>Contents</h2>
      <ul class="nav nav-pills nav-stacked">
<li><a href="#supported-data-structures">Supported data structures</a></li>
      <li><a href="#nse-in-layout-specifications">NSE in layout specifications</a></li>
      <li><a href="#access-to-tidygraph-algorithms-in-ggraph-code">Access to tidygraph algorithms in ggraph code</a></li>
      </ul>
</div>
      </div>

</div>


      <footer><div class="copyright">
  <p>Developed by Thomas Lin Pedersen.</p>
</div>

<div class="pkgdown">
  <p>Site built with <a href="http://pkgdown.r-lib.org/">pkgdown</a>.</p>
</div>

      </footer>
</div>

  

  </body>
</html>
